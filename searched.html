<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Searched Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</head>
<body>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="index.html"><h1>Book Store App</h1> </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="history.html">History </a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" href="searched.html">Searched </a>
              </li>
          </ul>
        </div>
      </nav> <br>
      <!-- search history -->
<div id="search-history"></div>

<!-- book details -->
<div id="book-details"></div>
<script>
    const bookDetailsDiv = document.querySelector('#book-details');

// Function to fetch book data from the Google Books API and display all details
const fetchBookDetails = async (query) => {
  const url = `https://www.googleapis.com/books/v1/volumes?q=percy+jackson`;
  const response = await fetch(url);
  const data = await response.json();
  const book = data.items;

  const title = book.volumeInfo.title;
  const author = book.volumeInfo.authors ? book.volumeInfo.authors[0] : 'Unknown Author';
  const description = book.volumeInfo.description ? book.volumeInfo.description : 'No description available.';
  const cover = book.volumeInfo.imageLinks ? book.volumeInfo.imageLinks.thumbnail : 'https://via.placeholder.com/150x200?text=No+Cover+Available';
  const pageCount = book.volumeInfo.pageCount ? book.volumeInfo.pageCount : 'Unknown';
  const publishedDate = book.volumeInfo.publishedDate ? book.volumeInfo.publishedDate : 'Unknown';
  const publisher = book.volumeInfo.publisher ? book.volumeInfo.publisher : 'Unknown';
  const buyLink = book.saleInfo.buyLink ? book.saleInfo.buyLink : '';
  const price = book.saleInfo.listPrice ? book.saleInfo.listPrice.amount : 'Not for Sale';

  const bookDetailsHTML = `
    <h2>${title}</h2>
    <p>By ${author}</p>
    <img src="${cover}" alt="Cover for ${title}">
    <p>${description}</p>
    <ul>
      <li>Page Count: ${pageCount}</li>
      <li>Published Date: ${publishedDate}</li>
      <li>Publisher: ${publisher}</li>
      <li>Price: ${price}</li>
    </ul>
    ${buyLink ? `<a href="${buyLink}" target="_blank">Buy Now</a>` : ''}
  `;

  bookDetailsDiv.innerHTML = bookDetailsHTML;
};

// Function to display search history from localStorage
const displaySearchHistory = () => {
  const searches = JSON.parse(localStorage.getItem('searchHistory')) || [];
  const searchHistoryDiv = document.querySelector('#search-history');
  searchHistoryDiv.innerHTML = '';

  if (searches.length === 0) {
    searchHistoryDiv.innerHTML = '<p>No search history found.</p>';
    return;
  }

  searches.forEach((query) => {
    const searchItem = document.createElement('div');
    searchItem.classList.add('search-item');
    searchItem.textContent = query.Search;
    searchItem.addEventListener('click', () => {
      fetchBookDetails(query.Search);
    });
    searchHistoryDiv.appendChild(searchItem);
  });
};

displaySearchHistory();

</script>
</body>
</html>